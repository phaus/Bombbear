@(message: String, player: String)

@main("Welcome to Bombbear!") {

	<div id="player-list"></div>
	
	<script type="text/javascript">
		enchant(); // initialize
	    var game = new Core(1280, 720); // game stage
	    game.preload('/assets/images/@(player).png'); // preload image
	    game.preload('/assets/images/map1.png'); // preload image
	    game.fps = 20;
	$.getJSON("@routes.Application.players()", function( data ) {
		var content = "";
		var list = $("#player-list");
		list.attr('style', 'position:absolute; right: 10px; border: solid 1px;');
		content = "<table>";
		content += "<thead><tr><td>Spieler-ID:</td><td>Charakter-File:</td></tr></thead>";
		content += "<tbody>";
		$.each(data.players, function(key, value) {
			content += "<tr><td>" + value.username + "</td><td>" + value.character + "</td></tr>";
		});
		content += "</tbody></table>";
		list.html(content);
	});
	
	
	
 	$.getJSON("@routes.Application.map()", function( data ) {
	    game.onload = function(){
		
		// Obstacle Detection on Maps
		var map = new Map(16, 16);
		map.image = game.assets['/assets/images/map1.png'];
		map.loadData(data.fieldMap);
		map.collisionData = data.colMap;
		 
		if (map.hitTest(100,100) === true) {
		  console.log('hit');
		}
		 
		game.rootScene.addChild(map);
		var bear = new Sprite(32, 32);
		bear.image = game.assets['/assets/images/@(player).png'];
		game.rootScene.addChild(bear);
		bear.frame = [6, 6, 7, 7];   // select sprite frame
	
		bear.tl.moveBy(320, 0, 40)   // move right
			.scaleTo(-1, 1, 1)		// turn left
			.moveBy(0, 320, 40)		// move down
		    .moveBy(-320, 0, 40)     // move left
		    .scaleTo(1, 1, 1)		// turn right
		    .moveBy(0, -320, 40)	// move up
		    .loop();                 // loop it
	    
			if (map.hitTest(bear.x, bear.y) === true) {
			    alert(bear.x + " und " + bear.y);
			}
		};
	
		game.start(); // start your game!
    });
        </script>
}
